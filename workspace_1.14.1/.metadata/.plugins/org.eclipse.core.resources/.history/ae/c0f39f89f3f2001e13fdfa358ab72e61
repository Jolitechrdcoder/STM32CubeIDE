/*
 * encoder_jorge.c
 *
 *  Created on: Apr 4, 2024
 *      Author: mecat
 */

#include "encoder_jorge.h"

#define maxport GPIOB
#define a1 GPIO_PIN_5
#define b1 GPIO_PIN_6


int counter=0;
void encoder_loop(void){

	if (HAL_GPIO_ReadPin(maxport, a1) == GPIO_PIN_RESET)
		  {
	          if (HAL_GPIO_ReadPin(maxport, b1) == GPIO_PIN_RESET)
	              {
	        	  while(HAL_GPIO_ReadPin(maxport, b1) == GPIO_PIN_RESET){};
				   counter--;
				  while(HAL_GPIO_ReadPin(maxport, a1) == GPIO_PIN_RESET){};
				  HAL_Delay(10);
			      }




	          if (HAL_GPIO_ReadPin(maxport, b1) == GPIO_PIN_SET)
	                        {
	                  	  while(HAL_GPIO_ReadPin(maxport, b1) == GPIO_PIN_SET){};
	          			   counter++;
	          			  while(HAL_GPIO_ReadPin(maxport, a1) == GPIO_PIN_RESET){};
	          			 while(HAL_GPIO_ReadPin(maxport, b1) == GPIO_PIN_RESET){};

	          			  HAL_Delay(10);
	          		      }
	          if (counter<0) counter =0;
	          if (counter>20) counter =20;


		  }
}

